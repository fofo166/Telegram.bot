post = instaloader.Post.from_shortcode(insta_loader.context, url.split("/")[-2])
            if post.is_video:
                insta_loader.download_post(post, target="instagram_media")
                await update.message.reply_video(video=open(f"instagram_media/{post.shortcode}.mp4", 'rb'))
            else:
                insta_loader.download_post(post, target="instagram_media")
                await update.message.reply_photo(photo=open(f"instagram_media/{post.shortcode}.jpg", 'rb'))
            os.remove(f"instagram_media/{post.shortcode}.mp4" if post.is_video else f"instagram_media/{post.shortcode}.jpg")
            await update.message.reply_text("ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰")
        except Exception as e:
            await update.message.reply_text(f'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ù† Instagram: {e}')
    else:
        await update.message.reply_text(
            f"Ø¹Ø°Ø±Ù‹Ø§ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª:\n\n{REQUIRED_CHANNEL}\n\n"
            "Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…ØŒ Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
        )

# Ø¯Ø§Ù„Ø© Ù„ØªÙ†Ø²ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Facebook
async def download_facebook_video(update: Update, context: ContextTypes.DEFAULT_TYPE, url: str):
    user_id = update.message.from_user.id
    if await is_user_member(user_id, context):
        try:
            await update.message.reply_text("Ø¬Ø§Ø±ÙŠ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Facebook... â³")
            
            # ØªÙ‡ÙŠØ¦Ø© yt-dlp
            ydl_opts = {
                'format': 'best',  # Ø£ÙØ¶Ù„ Ø¬ÙˆØ¯Ø© Ù…ØªØ§Ø­Ø©
                'outtmpl': 'facebook_media/%(title)s.%(ext)s',  # Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù…Ø¬Ù„Ø¯ facebook_media
            }

            with YoutubeDL(ydl_opts) as ydl:
                info = ydl.extract_info(url, download=True)
                file_path = ydl.prepare_filename(info)

            await update.message.reply_video(video=open(file_path, 'rb'))
            os.remove(file_path)
            await update.message.reply_text("ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰")
        except Exception as e:
            await update.message.reply_text(f'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Facebook: {e}')
    else:
        await update.message.reply_text(
            f"Ø¹Ø°Ø±Ù‹Ø§ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª:\n\n{REQUIRED_CHANNEL}\n\n"
            "Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…ØŒ Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
        )

# Ø¯Ø§Ù„Ø© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†ØµÙŠØ©
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.message.from_user.id
    if await is_user_member(user_id, context):
        text = update.message.text

        # ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
        youtube_regex = r"(https?://)?(www\.)?(youtube\.com/watch\?v=|youtu\.be/)[\w-]+"
        instagram_regex = r"(https?://)?(www\.)?instagram\.com/(p|reel)/[\w-]+"
        facebook_regex = r"(https?://)?(www\.)?facebook\.com/.+/videos/\d+"

        if re.match(youtube_regex, text):
            await download_youtube_video(update, context, text)
        elif re.match(instagram_regex, text):
            await download_instagram_media(update, context, text)
        elif re.match(facebook_regex, text):
            await download_facebook_video(update, context, text)
        else:
            await update.message.reply_text("Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. Ø£Ø±Ø³Ù„ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ Ù…Ù† YouTube Ø£Ùˆ Instagram Ø£Ùˆ Facebook.")
    else:
        await update.message.reply_text(
            f"Ø¹Ø°Ø±Ù‹Ø§ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª:\n\n{REQUIRED_CHANNEL}\n\n"
            "Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…ØŒ Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
        )

def main():
    # Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨ÙˆØª
    application = Application.builder().token(TELEGRAM_BOT_TOKEN).build()

    # ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø£ÙˆØ§Ù…Ø±
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("help", help_command))
    
    # Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†ØµÙŠØ©
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    # Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª
    application.run_polling()

if name == 'main':
    main()